"use strict";var BrowserDetect,GUID,asciistring,asciistring_lowercase,asciistring_lowercase_nospace,asciistring_no_specials,async_call,async_call_retries,b64_decode_mstyle,b64_encode_mstyle,b64_object_mstyle,b64_uri,b64mstyle,base64_decode,base64_encode,bool_parse,directive_check_slow_timeout,directive_check_timeout,exist,exist_string,exist_truth,g_format_file_size,g_http_error,g_running_local,get_local_time,ismobile,object_b64_mstyle,other_with,pass,pg,print,running_local,safe_b64,set_time_out,start_time,unique_number,uri_b64,warning,__slice=[].slice,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return -1;};g_running_local=null;directive_check_timeout=100;directive_check_slow_timeout=500;pg=function(v){var print_key;if(exist(v)){if(exist(window.globals[v])){if(typeof console!=="undefined"&&console!==null)console.log(v,window.globals[v]);}else{print_key=function(k){if(String(k).indexOf(v)>=0)return typeof console!=="undefined"&&console!==null?console.log(v,"->",k,window.globals[k]):void 0;};_.each(_.keys(window.globals),print_key);}}else{print_key=function(k){return typeof console!=="undefined"&&console!==null?console.log(k,window.globals[k]):void 0;};_.each(_.keys(window.globals),print_key);}return "";};set_time_out=function(func,delay){return setTimeout(func,delay);};async_call=function(func){return setTimeout(func,directive_check_timeout);};if(window.btoa!=null)base64_encode=window.btoa;else base64_encode=window.base64.encode;if(window.atob!=null)base64_decode=window.atob;else base64_decode=window.base64.decode;if(!String.prototype.trim)String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"");};String.prototype.startsWith=function(suffix){return this.indexOf(suffix)===0;};String.prototype.endsWith=function(suffix){return this.indexOf(suffix,this.length-suffix.length)!==-1;};uri_b64=function(s){s=encodeURI(s);return base64_encode(s);};safe_b64=function(s){s=encodeURI(s);s=base64_encode(s);s=s.replace(/\=/g,"-");return s;};exist_string=function(value){if(value!=null)switch(value){case void 0:case null:case "null":case "undefined":return false;default:return true;}else return false;};exist=function(value){if(exist_string(value)){if(value==="")return false;if(String(value)==="NaN")return false;if(String(value)==="undefined")return false;if(value.trim!=null)if(value.trim()==="")return false;return true;}else return false;};exist_truth=function(value){if(exist(value))switch(value){case "0":case 0:return false;case "1":case 1:return true;case "false":case false:return false;case "true":case true:return true;default:warning("app_basic.cf:103","exist_truth neither true or false",value);return false;}else return false;};b64mstyle="data:b64encode/mstyle,";b64_encode_mstyle=function(s){if(!exist(s))return s;if(!exist(s.indexOf))return s;if(s.indexOf(b64mstyle)===0)return s;s=encodeURIComponent(s);s=base64_encode(s);s=s.replace(/\=/g,"-");return b64mstyle+s;};b64_decode_mstyle=function(s){var error;if(!exist(s))return s;if(!exist(s.indexOf))return s;if(s.indexOf(b64mstyle)!==0)return s;s=s.replace(b64mstyle,"");s=s.replace(/-/g,"=");s=base64_decode(s);try{s=decodeURIComponent(s);}catch(_error){error=_error;s="error decoding";}return s;};object_b64_mstyle=function(v){var set_var;set_var=function(k){return v[k]=object_b64_mstyle(v[k]);};if(_.isObject(v)){_.each(_.keys(v),set_var);return v;}else{v=b64_encode_mstyle(v);return v;}};b64_object_mstyle=function(v){var set_var;set_var=function(k){return v[k]=b64_object_mstyle(v[k]);};if(_.isObject(v)){_.each(_.keys(v),set_var);return v;}else{v=b64_decode_mstyle(v);return v;}};b64_uri=function(s){s=base64_decode(s);return decodeURI(s);};pass=true;asciistring=function(s){var ns,testchar;ns="";testchar=function(c){var code;code=c.charCodeAt(0);switch(true){case code>=48&&code<=57:return ns+=c;case code>=65&&code<=90:return ns+=c;case code>=97&&code<=122:return ns+=c;case code===32:return ns+=c;case code===45:return ns+=c;case code===38:return ns+=c;case code===47:return ns+=c;case code===43:return ns+=c;default:return pass;}};_.each(s,testchar);return ns;};asciistring_no_specials=function(s){var ns,testchar;ns="";testchar=function(c){var code;code=c.charCodeAt(0);switch(true){case code>=48&&code<=57:return ns+=c;case code>=65&&code<=90:return ns+=c;case code>=97&&code<=122:return ns+=c;case code===32:return ns+=c;case code===45:return ns+=c;case code===38:return ns+=c;case code===43:return ns+=c;case code===214:return ns+="O";case code===214:return ns+="O";case code===246:return ns+="o";case code===47:return ns+=c;case code===8364:return ns+="EUR ";default:return ns+="";}};_.each(s,testchar);if(ns!=null)return ns;else return "";};asciistring_lowercase=function(s){var ns;ns="";s=s.toLowerCase();return asciistring(s);};asciistring_lowercase_nospace=function(s){var ns,stripspace;s=asciistring_no_specials(s);ns="";stripspace=function(i){if(i!==' ')return ns+=i;};_.each(s,stripspace);return ns;};g_format_file_size=function(bytes){if(bytes===0)return "-";if(typeof bytes!=="number")return "";if(bytes>=(1024*1024*1024))return(bytes/(1024*1024*1024)).toFixed(2)+" gb";if(bytes>=(1024*1024))return(bytes/(1024*1024)).toFixed(2)+" mb";if(bytes>=1024)return(bytes/1024).toFixed(2)+" kb";return bytes.toFixed(0)+" b.";};GUID=function(){var S4;S4=function(){return Math.floor(Math.random()*0x10000).toString(16);};return S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4();};get_local_time=function(){return new Date().getTime();};unique_number=function(){if(running_local)return new Date().getTime();else return 7;};window.cvar_show_debug_info=false;other_with={};window.g_logfile=[];start_time=get_local_time();print=function(){var cnt,coffee2cf,create_print_string,found_object,loop_others,msg,num_objects,obj,others,others2,others_length,print_str,shortdate,spaces,_base,_base1;msg=arguments[0],others=2<=arguments.length?__slice.call(arguments,1):[];if(exist(window.globals.g_browser)){if(window.globals.g_browser.browser==='Chrome'){switch(_.size(others)){case 0:if(typeof console!=="undefined"&&console!==null)console.log("%c"+msg,'color: crimson',others);break;case 1:if(typeof console!=="undefined"&&console!==null)console.log("%c"+msg,'color: crimson',others[0]);break;case 2:if((typeof (_base=others[0]).indexOf==="function"?_base.indexOf(".cf"):void 0)>0){if(typeof console!=="undefined"&&console!==null)console.log("%c"+msg+" "+others[0],'color: crimson',others[1]);}else if(typeof console!=="undefined"&&console!==null)console.log("%c"+msg,'color: crimson',others[0],others[1]);break;case 3:if((typeof (_base1=others[0]).indexOf==="function"?_base1.indexOf(".cf"):void 0)>0){if(typeof console!=="undefined"&&console!==null)console.log("%c"+msg+" "+others[0],'color: crimson',others[1],others[2]);}else if(typeof console!=="undefined"&&console!==null)console.log("%c"+msg,'color: crimson',others[0],others[1],others[2]);break;case 4:if(typeof console!=="undefined"&&console!==null)console.log("%c"+msg,'color: crimson',others[0],others[1],others[2],others[3]);break;default:if(typeof console!=="undefined"&&console!==null)console.log(others,msg);}}else switch(_.size(others)){case 0:if(typeof console!=="undefined"&&console!==null)console.log(msg);break;case 1:if(typeof console!=="undefined"&&console!==null)console.log(msg+" "+others[0]);break;case 2:if(typeof console!=="undefined"&&console!==null)console.log(msg+" "+others[0]+" "+others[1]);break;case 3:if(typeof console!=="undefined"&&console!==null)console.log(msg+" "+others[0]+" "+others[1]+" "+others[2]);break;case 4:if(typeof console!=="undefined"&&console!==null)console.log(msg+" "+others[0]+" "+others[1]+" "+others[2]+" "+others[3]);break;default:if(typeof console!=="undefined"&&console!==null)console.log(others,msg);}}else if(typeof console!=="undefined"&&console!==null)console.log(msg,others);if(!exist_truth(window.cvar_show_debug_info))return;if(msg.replace!=null){shortdate=""+(get_local_time()-start_time)/1000;while(shortdate.length<6)shortdate+=" ";shortdate+=" ";while(msg.length<22)msg+=" ";msg=shortdate+msg;others2=[];coffee2cf=function(obj){if(obj!=null)if(obj.replace!=null)return obj.replace(".cf",".cf");return obj;};others=(function(){var _i,_len,_results;_results=[];for(_i=0,_len=others.length;_i<_len;_i++){obj=others[_i];_results.push(coffee2cf(obj));}return _results;})();others_length=others.length;if(others!=null){cnt=0;loop_others=function(i){var l;if(exist(i))l=i.length;else l="undefined".length;if(other_with[cnt]!=null){if(other_with[cnt]<l)other_with[cnt]=l+2;}else other_with[cnt]=l+2;return cnt+=1;};_.each(others,loop_others);print_str="";cnt=0;spaces=function(n){var c,s;c=0;s=" ";while(c<n){s+=" ";c+=1;}return s;};found_object=-1;num_objects=0;create_print_string=function(s){if(_.isObject(s)){found_object=cnt;num_objects+=1;}else if(exist(s))print_str+=s+spaces(other_with[cnt]-s.length);else print_str+=s+" ";return cnt+=1;};_.each(others,create_print_string);if(found_object!==-1)if(num_objects>1)window.g_logfile.push(msg);else window.g_logfile.push(msg+" "+print_str+" "+others[found_object]);else window.g_logfile.push(msg+" "+print_str);}else window.g_logfile.push(msg+" "+String(others));window.g_logfile=window.g_logfile.slice(_.size(window.g_logfile)-150);return 1;}};warning=function(){var msg,others;msg=arguments[0],others=2<=arguments.length?__slice.call(arguments,1):[];if(typeof console!=="undefined"&&console!==null)console.log('%c------ important '+msg+' ---------','color: red');switch(_.size(others)){case 0:if(typeof console!=="undefined"&&console!==null)console.log(others);break;case 1:if(typeof console!=="undefined"&&console!==null)console.log(others[0],"\t\t");break;case 2:if(typeof console!=="undefined"&&console!==null)console.log(others[0],others[1],"\t\t");break;case 3:if(typeof console!=="undefined"&&console!==null)console.log(others[0],others[1],others[2],"\t\t");break;case 4:if(typeof console!=="undefined"&&console!==null)console.log(others[0],others[1],others[2],others[3],"\t\t");break;default:if(typeof console!=="undefined"&&console!==null)console.log(others);}return typeof console!=="undefined"&&console!==null?console.log('%c------------------------------------------------','color: red'):void 0;};async_call_retries=function(msg,func,retries){if(retries>20){print("app_basic.cf:451",msg,"async_call_retries slow");return setTimeout(func,directive_check_slow_timeout);}else return setTimeout(func,directive_check_timeout);};running_local=function(){var path_split;if(g_running_local!=null)return g_running_local;else{path_split=document.location.hostname;if(path_split==="127.0.0.1"||path_split==="192.168.14.107"){print("app_basic.cf:464","running local");return g_running_local=true;}else return g_running_local=false;}};g_http_error=function(data){var traceback;if(data.indexOf==null)if(data.data!=null)if(data.data.indexOf!=null)data=data.data;if(data.indexOf!=null){traceback=data.slice(data.indexOf("Exception Type:"),data.indexOf("FILES:"));if(exist(traceback)){warning("app_basic.cf:480"," **  django error  ** ",traceback);window.g_logfile.push(traceback);}}else{traceback=data;window.g_logfile.push(traceback);print("app_basic.cf:485",data);}return traceback;};ismobile=function(){if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))return true;else return false;};BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";return this.OS=this.searchString(this.dataOS)||"an unknown OS";},searchString:function(data){var dataProp,dataString,i;i=0;while(i<data.length){dataString=data[i].string;dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!==-1)return data[i].identity;}else if(dataProp)return data[i].identity;i+=1;}},searchVersion:function(dataString){var index;index=dataString.indexOf(this.versionSearchString);if(index===-1)return;return parseFloat(dataString.substring(index+this.versionSearchString.length+1));},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};bool_parse=function(bs){if(bs==="true")return true;else if(bs==="false")return false;else return bs;};angular.module("cryptoboxApp.base",[]).factory("memory",function($q){var _set;window.globals={};window.globals.g_first_tree_render=true;_set=function(key,value){var error,kv;if(key.indexOf("cvar_")===0)key=key.replace("cvar_","g_cvar_");if(key.indexOf("c_")===0)key=key.replace("c_","g_c_");kv=key+":"+value;if(key.indexOf("g_")===0){window.globals[key]=value;return;}error="not g_"+key;print("app_basic.cf:630",error);return warning("app_basic.cf:631",error);};return{set:function(key,value){if(!exist(key))warning("app_basic.cf:635","no key given");if(!exist(value)){if(typeof console!=="undefined"&&console!==null)console.log("(no value) -> "+key);value="";}return _set(key,value);},set_if_higher:function(key,value){var cv;cv=this.get(key);value=parseFloat(value);if(isNaN(value))throw "not a number";if(exist(cv)){if(cv<value)return this.set(key,value);}else return this.set(key,value);},critical_set:function(key,value){if(!exist(key))warning("app_basic.cf:655","no key given");if(!exist(value))throw new Error("critical set undefined value for key "+key);return _set(key,value);},set_no_warning:function(key,value){return _set(key,value);},all_prefix:function(key_prefix){var check,keys,result;keys=_.keys(window.globals);check=function(val){var v;if(val.indexOf("g_cvar_")===0){v=val.replace("g_cvar_","cvar_");if(v.indexOf(key_prefix)===0)return v;}if(val.indexOf(key_prefix)===0)return val;};result=_.filter(_.map(keys,check),function(val){return val!=null;});return result;},prefix:function(kp){return this.all_prefix(kp);},del_prefix:function(kp){var del_cache,_this=this;del_cache=function(key){return _this.del(key);};return _.each(this.all_prefix(kp),del_cache);},exist:function(key){if(!exist(key))return false;if(!exist(this.get(key)))return false;return true;},has:function(key){return this.exist(key);},get:function(key){var error,value;if(!exist(key))warning("app_basic.cf:699","no key given");if(key.indexOf("cvar_")===0)key=key.replace("cvar_","g_cvar_");if(key.indexOf("c_")===0)key=key.replace("c_","g_c_");if(key.indexOf("g_")===0){value=window.globals[key];return bool_parse(value);}error="globals should start with g_ ->"+key;print("app_basic.cf:709",error);return warning("app_basic.cf:710",error);},get_int:function(key){var val;val=this.get(key);return parseInt(val,10);},get_float:function(key){var val;val=this.get(key);return parseFloat(val);},set_one_read_value:function(key){_set(key,true);return true;},get_one_read_value:function(key){var val;val=this.get(key);this.del(key);if(exist(val))return true;return false;},get_promise:function(key){var p,val;p=$q.defer();val=this.get(key);if(val!=null)p.resolve(val);else p.reject();return p.promise;},del:function(key){var error;if(key.indexOf("cvar_")===0)key=key.replace("cvar_","g_cvar_");if(key.indexOf("c_")===0)key=key.replace("c_","g_c_");if(key.indexOf("g_")===0){delete window.globals[key];return;}error="globals should start with g_ (global) - "+key;print("app_basic.cf:751",key,"no g_ prefix");return warning("app_basic.cf:752",error);},reset:function(){var cookie_key,keep,key,_i,_len,_ref,_results;_ref=_.keys(window.globals);_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){key=_ref[_i];keep=false;if(key.indexOf("g_service")===0){print("app_basic.cf:759","stopping",key);clearInterval(window.globals[key]);}cookie_key=key;if(cookie_key.indexOf("g_c_")===0)cookie_key=cookie_key.replace("g_c_","c_");if(cookie_key.indexOf("c_")===0){if(cookie_key.indexOf("c_persist_")===0)keep=true;if(cookie_key.indexOf("c_const_persist_")===0)keep=true;}if(key.indexOf("g_persist_")===0)keep=true;if(!keep)_results.push(this.del(key));else _results.push(void 0);}return _results;},bool_test:function(key){var val;val=this.get(key);if(!exist(val)){this.set(key,false);val=false;}if(String(val)!=="true"&&String(val)!=="false")throw new Error("not a boolean");return exist_truth(val);},counter:function(key){if(!exist(this.get("g_counter_"+key)))return this.set("g_counter_"+key,0);},reset_counter:function(key){return this.set("g_counter_"+key,0);},get_counter:function(key){return this.get("g_counter_"+key);},mod_counter:function(key,modulus){var imod,ival,val;val=this.get("g_counter_"+key);ival=parseInt(val,10);imod=parseInt(modulus,10);return(ival%imod)===0;},increment_counter:function(key){var val;val=this.get("g_counter_"+key);if(!exist(val))val=0;val=parseInt(val,10);val=val+1;this.set("g_counter_"+key,val);return val;},decrement_counter:function(key){var val;val=this.get("g_counter_"+key);val=parseInt(val,10);val=val-1;this.set("g_counter_"+key,val);return val;}};}).factory("clientcookies",function(memory,utils){var set_memory,_set;this.loaded=false;_set=function(key,value){var error;if(key==="c_token")warning("app_basic.cf:827","c_token not allowed");if(key==="c_username")warning("app_basic.cf:829","c_username not allowed");if(key.indexOf("c_")===0){Store.set(key,value);return;}error="cookies should start with c_";print("app_basic.cf:835",error);return warning("app_basic.cf:836",error);};set_memory=function(cookie){if(cookie.key.indexOf("c_")===0)return memory.set(cookie.key,cookie.val);};return{ensure_memory:function(){var cookie_data;if(!this.loaded){cookie_data=Store.all();_.each(cookie_data,set_memory);return this.loaded=true;}},reset:function(){var check_delete,_this=this;check_delete=function(key){var cookie_key,keep;keep=false;cookie_key=key;if(cookie_key.indexOf("g_c_")===0)cookie_key=cookie_key.replace("g_c_","c_");if(cookie_key.indexOf("c_")===0)if(cookie_key.indexOf("c_persist_")===0)keep=true;else if(cookie_key.indexOf("c_const_persist_")===0)keep=true;if(!keep)return _this.del(cookie_key);};return _.each(_.keys(window.globals),check_delete);},del:function(key){memory.del(key);return Store.del(key);},set:function(key,value){if(key.indexOf("c_const_")===0)if(utils.exist(memory.get(key))){print("app_basic.cf:872",key+"is const",value,"ignored");return;}memory.set(key,value);return _set(key,value);},set_no_warning:function(key,value){memory.set(key,value);return _set(key,value);},get:function(key){var error,value;if(key==="c_token")warning("app_basic.cf:883","c_token not allowed");if(key==="c_username")warning("app_basic.cf:885","c_username not allowed");if(key.indexOf("c_")!==0){error="cookies should start with c_";warning("app_basic.cf:888",error);}value=memory.get(key);value=bool_parse(value);if(value!=null)return value;value=Store.get(key);if(utils.exist(value)){value=bool_parse(value);memory.set(key,value);return value;}return null;},has:function(key){var v;v=this.get(key);if(utils.exist(v))return true;return false;}};}).factory("utils",function(memory,dateFilter,$templateCache,$q,$http){var init,m_browser,m_os,m_version;m_browser=null;m_os=null;m_version=null;init=function(){var browser;BrowserDetect.init();m_browser=BrowserDetect.browser;m_version=BrowserDetect.version;m_os=BrowserDetect.OS;browser={};browser.browser=m_browser;browser.version=m_version;browser.os=m_os;return memory.set("g_browser",browser);};return{chrome:function(){if(m_browser==="Chrome")return true;return false;},ie8:function(){if(m_browser==="Explorer")if(parseInt(m_version,10)===8)return true;return false;},html5:function(){var v;v=memory.get("g_c_html5mode");return bool_parse(v);},split:function(str,splitter){var s,sp;s=String(str);sp=s.split(splitter);return sp;},splitlast:function(str,splitter){var s,sp;s=String(str);sp=s.split(splitter);return sp[_.size(sp)-1];},bool_parse:function(v){return bool_parse(v);},text_html:function(str){str=str.trim();return String(str).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\n/g,"<br/>");},percentage:function(current,range){var perc;current=parseFloat(current);range=parseFloat(range);perc=current/(range/100);if(range===0)return 0;if(perc>100)perc=100;if(isNaN(perc))return 0;return parseInt(perc,10);},full:function(arr){if(_.size(arr)>0)return true;return false;},empty:function(arr){if(_.size(arr)===0)return true;return false;},exclude:function(source,exclude){var check,new_array,_this=this;new_array=[];check=function(item){var check2,found;found=false;check2=function(item2){var check_key;check_key=function(key){if(!_.isObject(item[key]))if(String(item[key])===String(item2[key]))return found=true;};return _.each(_.keys(item2),check_key);};_.each(exclude,check2);if(!found)return new_array.push(item);};_.each(source,check);return new_array;},exclude_key:function(source,exclude,key){var check,new_array;new_array=[];check=function(item){var check2,found;found=false;check2=function(item2){if(String(item[key])===String(item2[key]))return found=true;};_.each(exclude,check2);if(!found)return new_array.push(item);};_.each(source,check);return new_array;},exclude_key_key:function(source,exclude,key,key2){var check,new_array;new_array=[];check=function(item){var check2,found;found=false;check2=function(item2){if(String(item[key])===String(item2[key2]))return found=true;};_.each(exclude,check2);if(!found)return new_array.push(item);};_.each(source,check);return new_array;},exclude_key_value:function(source,key,value){var check,new_array;new_array=[];check=function(item){var found;found=false;if(String(item[key])===String(value))found=true;if(!found)return new_array.push(item);};_.each(source,check);return new_array;},filter_key_value:function(source,key,value){var check,new_array,_this=this;new_array=[];check=function(item){var found,tmp;found=false;if(_.isObject(item)){tmp=_this.filter_key_value(item,key,value);if(_.size(tmp)>0)found=true;}if(item!=null)if(String(item[key])===String(value))found=true;if(found)return new_array.push(item);};_.each(source,check);return new_array;},map_to_values:function(source,key){var check,new_array,_this=this;new_array=[];check=function(item){var found;found=false;if(_.isObject(item[key]))return print("app_basic.cf:1074",_this.map_to_values(item,key));else if(exist(item[[key]]))return new_array.push(item[key]);};_.each(source,check);return new_array;},unique_object_list:function(source,key){var make_unique,new_array,_this=this;new_array=[];make_unique=function(item){var check,found;found=false;check=function(item2){if(item2[key]===item[key])return found=true;};_.each(new_array,check);if(!found)return new_array.push(item);};_.each(source,make_unique);return new_array;},unique_list:function(source){var make_unique,new_array,_this=this;new_array=[];make_unique=function(item){var check,found;found=false;check=function(item2){if(item2===item)return found=true;};_.each(new_array,check);if(!found)return new_array.push(item);};_.each(source,make_unique);return new_array;},slugify:function(text){text=text.toLowerCase();text=text.replace(/[^-a-zA-Z0-9,&\s]+/g,"");text=text.replace(/-/g,"_");text=text.replace(/\s/g,"_");while(text.indexOf("__")>0)text=text.replace("__","_");return text;},obj2json:function(obj){return JSON.stringify(obj);},json2obj:function(json){return JSON.parse(json);},same_object:function(obj1,obj2){var j1,j2;j1=this.obj2json(obj1);j2=this.obj2json(obj2);return j1===j2;},b64_encode_mstyle:function(s){return b64_encode_mstyle(s);},b64_decode_mstyle:function(s){return b64_decode_mstyle(s);},object_b64_mstyle:function(v){return object_b64_mstyle(v);},b64_object_mstyle:function(v){return b64_object_mstyle(v);},b64_uri:function(s){return b64_uri(s);},asciistring:function(s){return asciistring(s);},asciistring_no_specials:function(s){return asciistring_no_specials(s);},asciistring_lowercase:function(s){return asciistring_lowercase(s);},format_file_size:function(bytes){return g_format_file_size(bytes);},browser:function(){if(!this.exist(m_browser))init();return m_browser;},is_phone:function(){if(memory.has("g_device_type"))if(memory.get("g_device_type")==="phone")return true;return false;},is_tablet:function(){if(memory.has("g_device_type"))if(memory.get("g_device_type")==="tablet")return true;return false;},is_desktop:function(){if(memory.has("g_device_type"))if(memory.get("g_device_type")==="desktop")return true;return false;},version:function(){if(!this.exist(m_version))init();return m_version;},os:function(){if(!this.exist(m_os))init();return m_os;},smooth_progress_update:function(hard_progress,smooth_progress){var chance;if(this.ie8())return hard_progress;if(hard_progress>50)if(smooth_progress<20)smooth_progress=20;chance=4;if(smooth_progress>20)chance=500;if(Math.round(chance*Math.random())===2)smooth_progress+=1;if(hard_progress>98)if(smooth_progress>80)if(hard_progress>80)smooth_progress+=20*Math.random();else smooth_progress+=1;else if(smooth_progress>60)if(hard_progress>60)smooth_progress+=10*Math.random();else smooth_progress+=2*Math.random();else if(smooth_progress>20)if(hard_progress>20)smooth_progress+=10*Math.random();else if(Math.round(chance*Math.random())===2)smooth_progress+=10*Math.random();else smooth_progress+=5*Math.random();else smooth_progress+=2*Math.random();if(smooth_progress>100)smooth_progress=100;if(hard_progress!==100)if(smooth_progress>95)smooth_progress=95;return smooth_progress;},mail_admins:function(subject,message){var command,data,p,url;p=$q.defer();data={};data.subject=subject;data.message=message;command="mailadmins";url="/"+this.get_cryptobox_slug()+"/"+command+"/"+get_local_time();data=object_b64_mstyle(data);$http.post(url,data).then(function(succes){return p.resolve();},function(e){print("app_basic.cf:1251","error mailing admins");print("app_basic.cf:1252",e);return p.resolve();});return p.promise;},warning:function(){var add_error,add_errors,g_warnings,msg,others,spaces,warning_str,warnings;msg=arguments[0],others=2<=arguments.length?__slice.call(arguments,1):[];warnings=[];warnings.push(msg);add_error=function(i){return warnings.push(String(i));};_.each(others,add_error);warning("app_basic.cf:1264",msg,others);warning_str="";spaces="";add_errors=function(i){warning_str+=spaces+i+"\n";return spaces+="  ";};_.each(warnings,add_errors);this.mail_admins(this.get_cryptobox_slug()+" - javascript error",warning_str);return g_warnings=[];},digest:function(){return memory.critical_set("g_digest_requested",true);},force_digest:function(scope){var digest,_this=this;digest=function(){if(!scope.$$phase)return scope.$apply();};return _.defer(digest);},sanitize_url:function(url){url="/"+url;while(url.indexOf("//")!==-1)url=url.replace("//","/");return url;},trim_left:function(str,tv){var subs;subs=str.substring(0,tv.length);if(subs===tv)str=str.substring(tv.length,str.length);return str;},strip_left:function(str,tv){return this.trim_left(str,tv);},trim_right:function(str,tv){var subs;subs=str.substring(str.length-tv.length);if(subs===tv)str=str.substring(0,str.length-tv.length);return str;},strip_right:function(str,tv){return this.trim_right(str,tv);},capfirst:function(s){return s.charAt(0).toUpperCase()+s.toLowerCase().substring(1);},numbers_only_string:function(v){var i,s,_i,_len,_ref;if(!exist(v))v="";v=v.trim();if(v==="")return v;s="";for(_i=0,_len=v.length;_i<_len;_i++){i=v[_i];if(_ref=parseInt(i,10),__indexOf.call([0,1,2,3,4,5,6,7,8,9],_ref)>=0)s+=i;}return s;},count:function(string,subString,allowOverlapping){var n,pos,step;string+="";subString+="";if(subString.length<=0)return string.length+1;n=0;pos=0;step=(allowOverlapping?1.:subString.length);while(true){pos=string.indexOf(subString,pos);if(pos>=0){n++;pos+=step;}else break;}return n;},strip_file_extension:function(fname){var cnt_points,extension,i,join_name,new_name,ret,split_name,_i,_ref;if(fname.indexOf(".")!==-1){cnt_points=this.count(fname,".");if(cnt_points>1)for(i=_i=1,_ref=cnt_points-1;1<=_ref?_i<=_ref:_i>=_ref;i=1<=_ref?++_i:--_i)fname=fname.replace(".","±");split_name=fname.split(".");extension=split_name[split_name.length-1];if(extension.indexOf(" ")!==-1)return String(fname).trim();split_name=split_name.slice(0,split_name.length-1);new_name="";join_name=function(i){return new_name+=i;};_.each(split_name,join_name);new_name=new_name.replace(/±/g,".");ret=this.trim_right(new_name,".");if(ret!=null)return ret;return "";}return ret=this.trim_right(fname," ");},file_extension:function(fname){var cnt_points,extension,i,split_name,_i,_ref;if(fname.indexOf(".")!==-1){cnt_points=this.count(fname,".");if(cnt_points>1)for(i=_i=1,_ref=cnt_points-1;1<=_ref?_i<=_ref:_i>=_ref;i=1<=_ref?++_i:--_i)fname=fname.replace(".","±");split_name=fname.split(".");extension=split_name[split_name.length-1];if(extension.indexOf(" ")!==-1)return fname;if(_.size(extension)>0)return String(extension).trim();}return String(fname).trim();},is_mobile:function(){return /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent);},title:function(title){return document.title=this.get_cryptobox_slug()+" | "+title.toLowerCase();},exist_string:function(value){return exist_string(value);},exist:function(value){return exist(value);},assert:function(key,value){if(!this.exist(value))return warning("app_basic.cf:1408","value named "+key+" does not exist");},exist_truth:function(value){return exist_truth(value);},stripTrailingSlash:function(str){while(str.substr(-1)==="/")str=str.substr(0,str.length-1);return str;},strEndsWith:function(str,suffix){return str.indexOf(suffix,str.length-suffix.length)!==-1;},get_cryptobox_slug:function(){" parse out the toplevel url, this == the slug ";var cryptobox_slug,path_split;cryptobox_slug=memory.get("g_cryptobox_slug");if(cryptobox_slug)return cryptobox_slug;else{path_split=document.location.pathname.split("/");cryptobox_slug=path_split[1];memory.set("g_cryptobox_slug",cryptobox_slug);return cryptobox_slug;}},format_date:function(date){return dateFilter(date,'EEEE d MMMM y');},format_time:function(date){return dateFilter(date,'H:mm:ss');},format_datetime_medium:function(date){return dateFilter(date,'d MMM y H:mm');},format_datetime_long:function(date){return dateFilter(date,'EEEE d MMMM y H:mm:ss');},debug_mode:function(){var g_debugmode;g_debugmode=memory.get("g_debugmode");if(!this.exist(g_debugmode)){memory.set("g_debugmode",running_local());g_debugmode=memory.get("g_debugmode");}return g_debugmode;},remove_cache:function(){if(this.debug_mode())return $templateCache.removeAll();},sha3:function(){var append_data,data,hashdata;data=1<=arguments.length?__slice.call(arguments,0):[];hashdata="";append_data=function(d){hashdata+=String(d);return hashdata+="+";};_.each(data,append_data);hashdata=this.trim_right(hashdata,"+");return CryptoJS.SHA3(hashdata).toString();},http_get:function(url){var p;print("app_basic.cf:1468","http_get",url);p=$q.defer();$http.get(url).then(function(result){return p.resolve(result.data);},function(e){return p.reject(g_http_error(e.data));});return p.promise;},http_get_cached:function(url){var content,p,url_key;print("app_basic.cf:1481","http_get_cached",url);url_key=asciistring_lowercase_nospace(url);p=$q.defer();content=memory.get("g_http_get_cached_"+url_key);if(exist(content))p.resolve(content);else $http.get(url).then(function(result){memory.set("g_http_get_"+url_key,result.data);return p.resolve(result.data);},function(e){return p.reject(g_http_error(e.data));});return p.promise;}};}).factory("urls",function(utils,memory,clientcookies){var _safe;_safe=function(parameter){return safe_b64(parameter);};return{http_error:function(data){return g_http_error(data);},make_route:function(path){var cached_route,cryptobox_slug,new_path;cached_route=memory.get("g_"+path);if(cached_route!=null)return cached_route;cryptobox_slug=utils.get_cryptobox_slug();if(clientcookies.get("c_html5mode"))new_path="/"+cryptobox_slug+"/"+path;else new_path="/"+path;new_path=new_path.replace(new RegExp("//","g"),"/");memory.set("g_"+path,new_path);return new_path;},make_absolute_route:function(path){var cached_route,cryptobox_slug,html5_mode,new_path;cached_route=memory.get("g_"+path);cryptobox_slug=utils.get_cryptobox_slug();if(memory.has("g_c_html5mode"))html5_mode=memory.get("g_c_html5mode");else html5_mode=clientcookies.get("c_html5mode");if(!html5_mode)new_path="/"+cryptobox_slug+"#/"+path;else new_path="/"+cryptobox_slug+"/"+path;new_path=new_path.replace(new RegExp("//","g"),"/");memory.set("g_"+path,new_path);return new_path;},change_route:function($location,path,cvar){var safe_path;path=utils.stripTrailingSlash(path);safe_path=this.make_route(path);if(cvar!=null)if(path.indexOf("docs/")>0)if(path.indexOf("add")===-1)cvar.set("cvar_last_path",path);if($location.path()!==safe_path)return $location.path(safe_path);},change_document_location:function(path){var cryptobox_slug_path,safe_path;path=utils.stripTrailingSlash(path);safe_path=this.make_route(path);cryptobox_slug_path="/"+utils.get_cryptobox_slug();if(clientcookies.get("c_html5mode"))return document.location=safe_path;else return document.location=cryptobox_slug_path+"#"+safe_path;},safe:function(parameter){return _safe(parameter);},command:function(msg,command){" format a command url ";var url;url="/"+utils.get_cryptobox_slug()+"/"+command+"/"+get_local_time();return url;},postcommand:function(msg,command,operation){" format a command url ";var url;url="/"+utils.get_cryptobox_slug()+"/"+command+"/"+get_local_time();return url;},key_value:function(command,key,value){" format a command url ";var cryptobox_slug,url;get_local_time();cryptobox_slug=utils.get_cryptobox_slug();if((cryptobox_slug==null)||cryptobox_slug==="undefined")print("app_basic.cf:1586","cryptobox slug == undefined");url="/"+cryptobox_slug+"/"+command+"/"+_safe(key)+"/"+_safe(value)+"/"+get_local_time();print("app_basic.cf:1589","urls.key_value",url);return url;},logout:function(http){var login_message,msg_log;print("app_basic.cf:1593","logout");login_message=clientcookies.get("c_login_message");memory.reset();clientcookies.reset();if(utils.exist(login_message))clientcookies.set("c_login_message",login_message);if(!running_local())return this.change_document_location("/logout");else{msg_log=function(){warning("app_basic.cf:1603","on the server you would be logged off now");if(String(document.location).indexOf("login")<0)return set_time_out(msg_log,1000);};return msg_log();}}};});