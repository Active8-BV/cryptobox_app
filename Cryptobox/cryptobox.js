// Generated by CoffeeScript 1.6.2
var child_process, cryptobox_ctrl, path;

child_process = require("child_process");

path = require('path');

angular.module("cryptoboxApp", ["cryptoboxApp.base"]);

cryptobox_ctrl = function($scope, $q, memory, utils) {
  var run_command;

  memory.set("g_running", true);
  run_command = function(cmd_name) {
    var cmd_to_run, options, p, process_result;

    console.log("cryptobox.cf:12", cmd_name);
    cmd_to_run = path.join(process.cwd(), "commands");
    cmd_to_run = path.join(cmd_to_run, cmd_name);
    p = $q.defer();
    process_result = function(error, stdout, stderr) {
      if (utils.exist(stderr)) {
        console.log("cryptobox.cf:19", stderr);
      }
      if (utils.exist(error)) {
        p.reject(error);
      } else {
        console.log("cryptobox.cf:23", "resolving");
        p.resolve(stdout);
      }
      return utils.force_digest($scope);
    };
    options = {
      encoding: 'utf8',
      timeout: 15000,
      maxBuffer: 200 * 1024,
      killSignal: 'SIGTERM',
      cwd: null,
      env: null
    };
    child_process.exec(cmd_to_run, options, process_result);
    return p.promise;
  };
  $scope.python_version = run_command("pyversion");
  $scope.handle_change = function() {
    return $scope.yourName = handle($scope.yourName);
  };
  $scope.file_input_change = function() {
    return py_file_input_change($scope.file_input);
  };
  return $scope.test = function() {
    return alert("hello");
  };
};
